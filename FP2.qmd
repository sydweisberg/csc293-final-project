---
title: "FP2"
format: pdf
editor: visual
---

## Loading and Cleaning the Data

```{r, warning=FALSE, message=FALSE}
# reading in csvs and creating df
library(tidyverse)

stardew_all <- read.csv("stardew_all.csv") |> select(!Timestamp) |> mutate(from = "All")
stardew_smith <- read.csv("stardew_smith.csv") |> select(!Timestamp) |> mutate(from = "Smith")

stardew_data <- rbind(stardew_all, stardew_smith)

stardew_data <- stardew_data |> filter(gender != "Other")
```


## Distribution of The Data
```{r echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
ggplot(data = stardew_data, aes(x = marriage_candidate, fill = from)) + geom_bar() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(title = "Marriage Choices by Data Source", x = "Marriage Choice", y = "Count") + scale_fill_manual(values = c("#151152", "#B52121"))
```
```{r echo=FALSE}
ggplot(data = stardew_data, aes(x=age, color=gender)) +
  geom_freqpoly(binwidth = 10, size = 1.25) +
  scale_color_manual(values = c('#6B3710', '#DDA059', '#59C9F1')) + theme_minimal() + labs(title = "Age Distribution By Gender")
```

```{r echo=FALSE}
sexuality_freq <- table(stardew_data$sexuality)
pie(sexuality_freq, cex=.75, radius = 1, col = c('#59C9F1', '#151152', '#B52121', '#6B3710', '#FFD921'), main = "Sexuality Distribution")
```


## Splitting Up Data for Cross Validation

```{r}
# separating the data into train and test data
set.seed(1) # set seed

indices <- sample(seq(152), 106) # find 108 random indices

train <- stardew_data[indices,] # use those indices for training data

test_data <- stardew_data[-indices,] # use all the other ones for testing
test_marriage <- stardew_data$marriage_candidate[-indices] # get true marriage candidates for testing
```

## Naive Bayes Model

```{r}
# Naive Bayes
library(e1071)
train <- indices
nb.fit <- naiveBayes(marriage_candidate ~ gender + sexuality + age, data = stardew_data, subset = train)
nb.fit
nb.class <- predict(nb.fit, test_data)
table(nb.class, test_data$marriage_candidate)
mean(nb.class == test_data$marriage_candidate)
```
Our Naive Bayes model correctly predicts marriage candidate 26% of the time. 